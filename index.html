<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="陌洛凉">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="陌洛凉">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="陌洛凉">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 6331672019997820000,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/"/>

  <title> 陌洛凉 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-right 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">陌洛凉</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/01/在Swift中使用JSON/" itemprop="url">
                  在Swift中使用JSON
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-12-01T01:25:01+08:00" content="2016-12-01">
              2016-12-01
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>第一次尝试译文，如果有错误谢谢指正。这里面的例子有的是我自己通过XCTest测试的. KennyBest!</p>
</blockquote>
<p>译文地址：<a href="https://developer.apple.com/swift/blog/?id=37" target="_blank" rel="external">https://developer.apple.com/swift/blog/?id=37</a>  </p>
<p>如果你的APP和web程序进行交互，那么从服务器返回的数据大都是JSON格式。你可以使用<code>Foundation</code>框架中的<code>JSONSerialization</code>类将JSON数据转化为<code>Swift</code>类型数据，例如<code>Dictionary</code>、<code>Array</code>、<code>String</code>、<code>Number</code>、Bool。然而，你并不能确定从服务器获取到的<code>JSON</code>值或者结构，正确地转化模型对象变成难题。这篇博文正是描述一些当你使用<code>JSON</code>交互时可采用的途径。  </p>
<p>&lt;! – more –&gt;</p>
<h2 id="从JSON中取数据"><a href="#从JSON中取数据" class="headerlink" title="从JSON中取数据"></a>从JSON中取数据</h2><p><code>JSONSerializtion</code>类提供了<code>jsonObject(with:options:)</code>类方法返回数据类型为<code>Any</code>数据，如果当数据不能被解析时抛出一个错误。 </p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">func testExample() &#123;</div><div class="line"></div><div class="line">    let <span class="string">dictionary:</span> [<span class="string">String :</span> String] = [ <span class="string">"name"</span> : <span class="string">"lilingjie"</span> ]</div><div class="line">    let <span class="string">data:</span> Data = <span class="keyword">try</span>! JSONSerialization.data(<span class="string">withJSONObject:</span> dictionary, <span class="string">options:</span> .prettyPrinted)</div><div class="line">    </div><div class="line">    let retDictionary = <span class="keyword">try</span>? JSONSerialization.jsonObject(with: data, <span class="string">options:</span> .allowFragments) <span class="keyword">as</span>! [<span class="string">String :</span> String]</div><div class="line">    XCTAssertEqual(dictionary, retDictionary!, <span class="string">"JSONSerialization convert JSON to Swift data type"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>  
<p>尽管有效的<code>JSON</code>可能只包含单个数据，从服务器响应的数据通常以数组或者字典作为最外层模型进行编码。你可以在<code>if</code>或<code>guard</code>语法中使用可选绑定和<code>as?</code>或<code>as!</code>类型指定操作符以常量的形式取出来已知类型的数据。通常指定为<code>[String : Any]</code>来从<code>JSON</code>数据中获取字典<code>Dictionary</code>,指定为<code>[Any]</code>获得数组<code>Array</code>（或者更明确元素类型的数组，像<code>[String]</code>）。 借助下标语法存取<code>Subscript</code>和枚举元素类型可选绑定后你可以通过key值摘取字典数据或者通过下标取得数组数据。  </p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="title">func</span> testJSONSerializtionToDictionary() &#123;</div><div class="line">        /** </div><div class="line">         以字典作为最外层的<span class="type">JSON</span>数据</div><div class="line">         &#123;</div><div class="line">            <span class="string">"someKey"</span>: <span class="number">42.0</span></div><div class="line">            <span class="string">"anotherKey"</span>: &#123;</div><div class="line">                <span class="string">"someNestedKey"</span>: true</div><div class="line">            &#125;</div><div class="line">         &#125;</div><div class="line">         */</div><div class="line">        <span class="keyword">let</span> jsonString = <span class="string">"&#123; \"someKey\":42.0 \"anotherKey\": &#123;\"someNestedKey\": true&#125;&#125;"</span></div><div class="line">        <span class="keyword">let</span> <span class="class"><span class="keyword">data</span> = jsonString.<span class="keyword">data</span>(<span class="title">using</span>: .<span class="title">utf8</span>)</span></div><div class="line">        </div><div class="line">        <span class="type">XCTAssertNotNil</span>(<span class="class"><span class="keyword">data</span>, "<span class="type">JSONSerialization</span> <span class="type">Data</span> 序列化失败")</span></div><div class="line">        </div><div class="line">        <span class="keyword">let</span> jsonWithObjectRoot = try? <span class="type">JSONSerialization</span>.jsonObject(with: <span class="class"><span class="keyword">data</span>!, options: .allowFragments)</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> dictionary = jsonWithObjectRoot <span class="keyword">as</span>? [<span class="type">String</span> : <span class="type">Any</span>] &#123;</div><div class="line">            <span class="type">XCTAssertNotNil</span>(dictionary, <span class="string">"convert OK"</span>)</div><div class="line">            <span class="type">XCTAssertEqual</span>(dictionary[<span class="string">"someKey"</span>] <span class="keyword">as</span>? <span class="type">Double</span>, <span class="number">42.0</span> , <span class="string">"two value not equal"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div></pre></td></tr></table></figure> 
<p><code>Swift</code>的<code>built-in</code>语言特性使得不需要导入额外的库或框架，就可以轻松安全地摘取和使用由<code>Foundation</code>框架中的API解码的<code>JSON</code>数据。  </p>
<h2 id="利用从JSON获取的数据创建Model"><a href="#利用从JSON获取的数据创建Model" class="headerlink" title="利用从JSON获取的数据创建Model"></a>利用从JSON获取的数据创建Model</h2><p>大部分APP遵循MVC设计模式，在一个类的定义中将<code>JSON</code>数据转化为对象变得很平常。<br>例如，当你写一个提供当地餐馆搜索结果的APP时，你可能实现一个<code>Restaurant</code>模型，在这个模型中定义一个接受<code>JSON</code>数据的构造函数和一个请求餐馆列表的类方法。<br>从下面这个类中考虑  </p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">import Foundation</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Restaurant</span> &#123;</span></div><div class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">Meal</span>: <span class="title">String</span> &#123;</span></div><div class="line">        <span class="keyword">case</span> breakfast, lunch, dinner</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    let <span class="symbol">name:</span> String</div><div class="line">    let <span class="symbol">coordinates:</span> (<span class="symbol">latitude:</span> Double, <span class="symbol">longitude:</span> Double)</div><div class="line">    let <span class="symbol">meals:</span> Set&lt;Meal&gt;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>   
<p>一个餐馆有<code>String</code>类型<code>name</code>属性,<code>元组</code>类型<code>coordinates</code>属性以及<code>Set</code>类型<code>Meal</code>属性。<br>服务器响应数据格式：<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">  </div><div class="line">&#123;</div><div class="line">	<span class="attr">"name"</span>: <span class="string">"Caffè Macs"</span>,</div><div class="line">	<span class="attr">"coordinates"</span>: &#123;</div><div class="line">		<span class="attr">"lat"</span>: <span class="number">37.330576</span>,</div><div class="line">		<span class="attr">"lng"</span>: <span class="number">-122.029739</span></div><div class="line">	&#125;,</div><div class="line">	<span class="attr">"meals"</span>: [<span class="string">"breakfast"</span>, <span class="string">"lunch"</span>, <span class="string">"dinner"</span>]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="写一个可选的JSON构造函数"><a href="#写一个可选的JSON构造函数" class="headerlink" title="写一个可选的JSON构造函数"></a>写一个可选的JSON构造函数</h3><p>为了从<code>JSON</code>数据转化为一个餐馆对象，写一个带有<code>Any</code>类型参数的构造函数，旨在从JSON数据中拿取数据且转变为属性。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Restaurant</span> </span>&#123;</div><div class="line">    <span class="keyword">init</span>?(json: [<span class="type">String</span>: <span class="type">Any</span>]) &#123;</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> name = json[<span class="string">"name"</span>] <span class="keyword">as</span>? <span class="type">String</span>,</div><div class="line">        <span class="keyword">let</span> coordinatesJSON = json[<span class="string">"coordinates"</span>] <span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">Double</span>],</div><div class="line">        <span class="keyword">let</span> latitude = coordinatesJSON[<span class="string">"lat"</span>],</div><div class="line">        <span class="keyword">let</span> longitude = coordinatesJSON[<span class="string">"lng"</span>],</div><div class="line">            <span class="keyword">let</span> mealsJSON = json[<span class="string">"meals"</span>] <span class="keyword">as</span>? [<span class="type">String</span>] <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">var</span> meals: <span class="type">Set</span>&lt;<span class="type">Meal</span>&gt; = []</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> string <span class="keyword">in</span> mealsJSON &#123;</div><div class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> meal = <span class="type">Meal</span>(rawValue: string) <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            meals.insert(meal)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.name = name</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.coordinates = (latitude, longitude)</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.meals = meals</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure> 
<p>如果你的APP与多个web服务进行交互，并且返回的数据不单一，那么就考虑实现多个构造函数来匹配所有可能的呈现方式。<br>在上面的例子中，通过可选绑定和<code>as?</code>类型指定来将JSON数据映射到模型的属性上。</p>
<h3 id="写一个带错误管理的JSON构造函数"><a href="#写一个带错误管理的JSON构造函数" class="headerlink" title="写一个带错误管理的JSON构造函数"></a>写一个带错误管理的JSON构造函数</h3><p>前一个例子实现了一个可选构造器，当反序列化失败时返回nil。另外，你也可以定义一个遵守<code>Error</code>协议的类型和实现一个可在反序列化失败时返回错误的构造器。  </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"> 	<span class="class"><span class="keyword">enum</span> <span class="title">SerializationError</span>: <span class="title">Error</span> </span>&#123;</div><div class="line">     	<span class="keyword">case</span> missing(<span class="type">String</span>)</div><div class="line">    	<span class="keyword">case</span> invaild(<span class="type">String</span>, <span class="type">Any</span>)</div><div class="line"> 	&#125;</div><div class="line">    </div><div class="line"><span class="comment">// 抛出错误的构造器</span></div><div class="line">    <span class="keyword">init</span>(data: [<span class="type">String</span>: <span class="type">Any</span>]) <span class="keyword">throws</span> &#123;</div><div class="line">        </div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> name = data[<span class="string">"name"</span>] <span class="keyword">as</span>? <span class="type">String</span> <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="type">SerializationError</span>.missing(<span class="string">"name"</span>)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> coordinatesJSON = data[<span class="string">"coordinates"</span>] <span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">Double</span>],</div><div class="line">            <span class="keyword">let</span> latitude = coordinatesJSON[<span class="string">"lat"</span>],</div><div class="line">            <span class="keyword">let</span> longitude = coordinatesJSON[<span class="string">"lng"</span>]</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="type">SerializationError</span>.missing(<span class="string">"coordinates"</span>)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">let</span> coordinates = (latitude, longitude)</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">case</span> (-<span class="number">90</span>...<span class="number">90</span>, -<span class="number">180</span>...<span class="number">180</span>) = coordinates <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="type">SerializationError</span>.invaild(<span class="string">"coordinates"</span>, coordinates)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> mealsJSON = data[<span class="string">"meals"</span>] <span class="keyword">as</span>? [<span class="type">String</span>] <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="type">SerializationError</span>.missing(<span class="string">"meals"</span>)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">var</span> meals: <span class="type">Set</span>&lt;<span class="type">Meal</span>&gt; = []</div><div class="line">        <span class="keyword">for</span> string <span class="keyword">in</span> mealsJSON &#123;</div><div class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> meal = <span class="type">Meal</span>(rawValue: string) <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">throw</span> <span class="type">SerializationError</span>.invaild(<span class="string">"meals"</span>, string)</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            meals.insert(meal)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.name = name</div><div class="line">        <span class="keyword">self</span>.coordinates = coordinates</div><div class="line">        <span class="keyword">self</span>.meals = meals</div><div class="line">    &#125;</div><div class="line"></div></pre></td></tr></table></figure>  
<p>这里，<code>Restaurtant</code>类里面声明了一个嵌套的<code>SerializationError</code>类型，定义了关联属性缺失和无效属性两种错误情况。这种抛出错误的构造器强于在序列化错误返回nil的构造器，可以抛出明确的交互错误。这次构造函数同样可以验证数据的合法性。</p>
<h3 id="写获取数据源的类方法"><a href="#写获取数据源的类方法" class="headerlink" title="写获取数据源的类方法"></a>写获取数据源的类方法</h3><p>一个web应用终端通常在单个<code>JSON</code>响应中返回多个数据源。比如<code>/search</code>终端可能返回0或多个匹配查询参数的餐馆，下面一段数据展示这种情况：  </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&#123;</div><div class="line">	<span class="attr">"query"</span>: <span class="string">"sandwich"</span>,</div><div class="line">	<span class="attr">"results_count"</span>: <span class="number">12</span>,</div><div class="line">	<span class="attr">"page"</span>: <span class="number">1</span>,</div><div class="line">	<span class="attr">"results"</span>: [</div><div class="line">		&#123;</div><div class="line">			<span class="attr">"name"</span>: <span class="string">"Caffè Macs"</span>,</div><div class="line">			<span class="attr">"coordinates"</span>: &#123;</div><div class="line">				<span class="attr">"lat"</span>: <span class="number">37.330576</span>,</div><div class="line">				<span class="attr">"lng"</span>: <span class="number">-122.029739</span></div><div class="line">			&#125;,</div><div class="line">			<span class="attr">"meals"</span>: [<span class="string">"breakfast"</span>, <span class="string">"lunch"</span>, <span class="string">"dinner"</span>]</div><div class="line">		&#125;,</div><div class="line">		...</div><div class="line">	]</div><div class="line">&#125;  </div><div class="line"></div></pre></td></tr></table></figure>
<p>你可以在<code>Restaurant</code>结构体中创建一个类方法，将查询条件正确地转化为<br>请求参数，并向服务器发送一个请求。这段代码同时也响应了服务器请求，解析<code>JSON</code>数据，把从<code>results</code>数组中获取的每一个字典转化为<code>Restaurant</code>对象，并在完成处理时自动返回。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Restaurant</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">let</span> urlComponents: <span class="type">URLComponents</span> <span class="comment">// base URL components of the web service</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">let</span> session: <span class="type">URLSession</span> <span class="comment">// shared session for interacting with the web service</span></div><div class="line"></div><div class="line">	<span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">restaurants</span><span class="params">(matching query: String, completion: <span class="params">([Restaurant])</span></span></span> -&gt; <span class="type">Void</span>) &#123;</div><div class="line">		<span class="keyword">var</span> searchURLComponents = urlComponents</div><div class="line">		searchURLComponents.path = <span class="string">"/search"</span></div><div class="line">		searchURLComponents.queryItems = [<span class="type">URLQueryItem</span>(name: <span class="string">"q"</span>, value: query)]</div><div class="line">		<span class="keyword">let</span> searchURL = searchURLComponents.url!</div><div class="line"></div><div class="line">		session.dataTask(url: searchURL, completion: &#123; (<span class="number">_</span>, <span class="number">_</span>, data, <span class="number">_</span>)</div><div class="line">			<span class="keyword">var</span> restaurants: [<span class="type">Restaurant</span>] = []</div><div class="line"></div><div class="line">			<span class="keyword">if</span> <span class="keyword">let</span> data = data,</div><div class="line">				<span class="keyword">let</span> json = <span class="keyword">try</span>? <span class="type">JSONSerialization</span>.jsonObject(with: data, options: []) <span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">Any</span>] &#123;</div><div class="line">				<span class="keyword">for</span> <span class="keyword">case</span> <span class="keyword">let</span> result <span class="keyword">in</span> json[<span class="string">"results"</span>] &#123;</div><div class="line">					<span class="keyword">if</span> <span class="keyword">let</span> restaurant = <span class="type">Restaurant</span>(json: result) &#123;</div><div class="line">						restaurants.append(restaurant)</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line"></div><div class="line">			completion(restaurants)</div><div class="line">		&#125;).resume()</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>  
<p>在viewController中，当搜索条件发生变化时调用这个方法。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">extension ViewController: UISearchResultsUpdating &#123;</div><div class="line">	func updateSearchResultsForSearchController(_ searchController: UISearchController) &#123;</div><div class="line">		<span class="keyword">if</span> let query = searchController<span class="selector-class">.searchBar</span><span class="selector-class">.text</span>, !query<span class="selector-class">.isEmpty</span> &#123;</div><div class="line">			Restaurant.restaurants(matching: query) &#123; restaurants <span class="keyword">in</span></div><div class="line">				self<span class="selector-class">.restaurants</span> = restaurants</div><div class="line">				self<span class="selector-class">.tableView</span><span class="selector-class">.reloadData</span>()</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>  
<p>用这种方式分离管理为获取餐馆数据提供了便利，即使具体实现发生改变。</p>
<h2 id="映射中的映射"><a href="#映射中的映射" class="headerlink" title="映射中的映射"></a>映射中的映射</h2><p>在不同的系统中对相同数据的呈现方式转换对于写软件来说是单调、必要的任务。<br>因为这些呈现方式的结构十分相似，这可能会创建高层级抽象过程去自动在不同呈现间映射。举例来说，一个类可能会为了自动初始化一个模型，利用<code>Swift</code>映射API去定义一种<code>JSON</code>key值和类里面的属性名称之间的映射关系。例如<code>Mirror</code>。<br>然而，我们会发现这些抽象过程性质在<code>Swift</code>语言特性的常规使用场景上并没有提供客观的收益，反而在调试问题和处理额外情景上带来了更多的困扰。通过上面的例子，构造器不但从<code>JSON</code>数据中获取和映射数据，还构造了混合数据类型和执行范围有效性验证。<br>为了实现这些所有的功能，基于映射途径可能会有较大长度。  对于我们的APP来说，评估效率时应该考虑这些。一些重复代码的消耗比使用错误的映射过程更有意义。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/29/JSONSeriaiztion/" itemprop="url">
                  未命名
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-29T20:52:17+08:00" content="2016-11-29">
              2016-11-29
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>layout: ‘[post]’<br>title: 在Swift中使用JSON<br>date: 2016-11-29 20:52:17</p>
<h2 id="tags-JSONSerializtion"><a href="#tags-JSONSerializtion" class="headerlink" title="tags: JSONSerializtion"></a>tags: JSONSerializtion</h2><blockquote>
<p>第一次尝试译文，如果有错误谢谢指正。这里面的例子有的是我自己通过XCTest测试的. KennyBest!</p>
</blockquote>
<p>译文地址：<a href="https://developer.apple.com/swift/blog/?id=37" target="_blank" rel="external">https://developer.apple.com/swift/blog/?id=37</a>  </p>
<p>如果你的APP和web程序进行交互，那么从服务器返回的数据大都是JSON格式。你可以使用<code>Foundation</code>框架中的<code>JSONSerialization</code>类将JSON数据转化为<code>Swift</code>类型数据，例如<code>Dictionary</code>、<code>Array</code>、<code>String</code>、<code>Number</code>、Bool。然而，你并不能确定从服务器获取到的<code>JSON</code>值或者结构，正确地转化模型对象变成难题。这篇博文正是描述一些当你使用<code>JSON</code>交互时可采用的途径。  </p>
<p>&lt;! – more –&gt;</p>
<h2 id="从JSON中取数据"><a href="#从JSON中取数据" class="headerlink" title="从JSON中取数据"></a>从JSON中取数据</h2><p><code>JSONSerializtion</code>类提供了<code>jsonObject(with:options:)</code>类方法返回数据类型为<code>Any</code>数据，如果当数据不能被解析时抛出一个错误。 </p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">func testExample() &#123;</div><div class="line"></div><div class="line">    let <span class="string">dictionary:</span> [<span class="string">String :</span> String] = [ <span class="string">"name"</span> : <span class="string">"lilingjie"</span> ]</div><div class="line">    let <span class="string">data:</span> Data = <span class="keyword">try</span>! JSONSerialization.data(<span class="string">withJSONObject:</span> dictionary, <span class="string">options:</span> .prettyPrinted)</div><div class="line">    </div><div class="line">    let retDictionary = <span class="keyword">try</span>? JSONSerialization.jsonObject(with: data, <span class="string">options:</span> .allowFragments) <span class="keyword">as</span>! [<span class="string">String :</span> String]</div><div class="line">    XCTAssertEqual(dictionary, retDictionary!, <span class="string">"JSONSerialization convert JSON to Swift data type"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>  
<p>尽管有效的<code>JSON</code>可能只包含单个数据，从服务器响应的数据通常以数组或者字典作为最外层模型进行编码。你可以在<code>if</code>或<code>guard</code>语法中使用可选绑定和<code>as?</code>或<code>as!</code>类型指定操作符以常量的形式取出来已知类型的数据。通常指定为<code>[String : Any]</code>来从<code>JSON</code>数据中获取字典<code>Dictionary</code>,指定为<code>[Any]</code>获得数组<code>Array</code>（或者更明确元素类型的数组，像<code>[String]</code>）。 借助下标语法存取<code>Subscript</code>和枚举元素类型可选绑定后你可以通过key值摘取字典数据或者通过下标取得数组数据。  </p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="title">func</span> testJSONSerializtionToDictionary() &#123;</div><div class="line">        /** </div><div class="line">         以字典作为最外层的<span class="type">JSON</span>数据</div><div class="line">         &#123;</div><div class="line">            <span class="string">"someKey"</span>: <span class="number">42.0</span></div><div class="line">            <span class="string">"anotherKey"</span>: &#123;</div><div class="line">                <span class="string">"someNestedKey"</span>: true</div><div class="line">            &#125;</div><div class="line">         &#125;</div><div class="line">         */</div><div class="line">        <span class="keyword">let</span> jsonString = <span class="string">"&#123; \"someKey\":42.0 \"anotherKey\": &#123;\"someNestedKey\": true&#125;&#125;"</span></div><div class="line">        <span class="keyword">let</span> <span class="class"><span class="keyword">data</span> = jsonString.<span class="keyword">data</span>(<span class="title">using</span>: .<span class="title">utf8</span>)</span></div><div class="line">        </div><div class="line">        <span class="type">XCTAssertNotNil</span>(<span class="class"><span class="keyword">data</span>, "<span class="type">JSONSerialization</span> <span class="type">Data</span> 序列化失败")</span></div><div class="line">        </div><div class="line">        <span class="keyword">let</span> jsonWithObjectRoot = try? <span class="type">JSONSerialization</span>.jsonObject(with: <span class="class"><span class="keyword">data</span>!, options: .allowFragments)</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> dictionary = jsonWithObjectRoot <span class="keyword">as</span>? [<span class="type">String</span> : <span class="type">Any</span>] &#123;</div><div class="line">            <span class="type">XCTAssertNotNil</span>(dictionary, <span class="string">"convert OK"</span>)</div><div class="line">            <span class="type">XCTAssertEqual</span>(dictionary[<span class="string">"someKey"</span>] <span class="keyword">as</span>? <span class="type">Double</span>, <span class="number">42.0</span> , <span class="string">"two value not equal"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div></pre></td></tr></table></figure> 
<p><code>Swift</code>的<code>built-in</code>语言特性使得不需要导入额外的库或框架，就可以轻松安全地摘取和使用由<code>Foundation</code>框架中的API解码的<code>JSON</code>数据。  </p>
<h2 id="利用从JSON获取的数据创建Model"><a href="#利用从JSON获取的数据创建Model" class="headerlink" title="利用从JSON获取的数据创建Model"></a>利用从JSON获取的数据创建Model</h2><p>大部分APP遵循MVC设计模式，在一个类的定义中将<code>JSON</code>数据转化为对象变得很平常。<br>例如，当你写一个提供当地餐馆搜索结果的APP时，你可能实现一个<code>Restaurant</code>模型，在这个模型中定义一个接受<code>JSON</code>数据的构造函数和一个请求餐馆列表的类方法。<br>从下面这个类中考虑  </p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">import Foundation</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Restaurant</span> &#123;</span></div><div class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">Meal</span>: <span class="title">String</span> &#123;</span></div><div class="line">        <span class="keyword">case</span> breakfast, lunch, dinner</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    let <span class="symbol">name:</span> String</div><div class="line">    let <span class="symbol">coordinates:</span> (<span class="symbol">latitude:</span> Double, <span class="symbol">longitude:</span> Double)</div><div class="line">    let <span class="symbol">meals:</span> Set&lt;Meal&gt;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>   
<p>一个餐馆有<code>String</code>类型<code>name</code>属性,<code>元组</code>类型<code>coordinates</code>属性以及<code>Set</code>类型<code>Meal</code>属性。<br>服务器响应数据格式：<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">  </div><div class="line">&#123;</div><div class="line">	<span class="attr">"name"</span>: <span class="string">"Caffè Macs"</span>,</div><div class="line">	<span class="attr">"coordinates"</span>: &#123;</div><div class="line">		<span class="attr">"lat"</span>: <span class="number">37.330576</span>,</div><div class="line">		<span class="attr">"lng"</span>: <span class="number">-122.029739</span></div><div class="line">	&#125;,</div><div class="line">	<span class="attr">"meals"</span>: [<span class="string">"breakfast"</span>, <span class="string">"lunch"</span>, <span class="string">"dinner"</span>]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="写一个可选的JSON构造函数"><a href="#写一个可选的JSON构造函数" class="headerlink" title="写一个可选的JSON构造函数"></a>写一个可选的JSON构造函数</h3><p>为了从<code>JSON</code>数据转化为一个餐馆对象，写一个带有<code>Any</code>类型参数的构造函数，旨在从JSON数据中拿取数据且转变为属性。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Restaurant</span> </span>&#123;</div><div class="line">    <span class="keyword">init</span>?(json: [<span class="type">String</span>: <span class="type">Any</span>]) &#123;</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> name = json[<span class="string">"name"</span>] <span class="keyword">as</span>? <span class="type">String</span>,</div><div class="line">        <span class="keyword">let</span> coordinatesJSON = json[<span class="string">"coordinates"</span>] <span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">Double</span>],</div><div class="line">        <span class="keyword">let</span> latitude = coordinatesJSON[<span class="string">"lat"</span>],</div><div class="line">        <span class="keyword">let</span> longitude = coordinatesJSON[<span class="string">"lng"</span>],</div><div class="line">            <span class="keyword">let</span> mealsJSON = json[<span class="string">"meals"</span>] <span class="keyword">as</span>? [<span class="type">String</span>] <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">var</span> meals: <span class="type">Set</span>&lt;<span class="type">Meal</span>&gt; = []</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> string <span class="keyword">in</span> mealsJSON &#123;</div><div class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> meal = <span class="type">Meal</span>(rawValue: string) <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            meals.insert(meal)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.name = name</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.coordinates = (latitude, longitude)</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.meals = meals</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure> 
<p>如果你的APP与多个web服务进行交互，并且返回的数据不单一，那么就考虑实现多个构造函数来匹配所有可能的呈现方式。<br>在上面的例子中，通过可选绑定和<code>as?</code>类型指定来将JSON数据映射到模型的属性上。</p>
<h3 id="写一个带错误管理的JSON构造函数"><a href="#写一个带错误管理的JSON构造函数" class="headerlink" title="写一个带错误管理的JSON构造函数"></a>写一个带错误管理的JSON构造函数</h3><p>前一个例子实现了一个可选构造器，当反序列化失败时返回nil。另外，你也可以定义一个遵守<code>Error</code>协议的类型和实现一个可在反序列化失败时返回错误的构造器。  </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"> 	<span class="class"><span class="keyword">enum</span> <span class="title">SerializationError</span>: <span class="title">Error</span> </span>&#123;</div><div class="line">     	<span class="keyword">case</span> missing(<span class="type">String</span>)</div><div class="line">    	<span class="keyword">case</span> invaild(<span class="type">String</span>, <span class="type">Any</span>)</div><div class="line"> 	&#125;</div><div class="line">    </div><div class="line"><span class="comment">// 抛出错误的构造器</span></div><div class="line">    <span class="keyword">init</span>(data: [<span class="type">String</span>: <span class="type">Any</span>]) <span class="keyword">throws</span> &#123;</div><div class="line">        </div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> name = data[<span class="string">"name"</span>] <span class="keyword">as</span>? <span class="type">String</span> <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="type">SerializationError</span>.missing(<span class="string">"name"</span>)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> coordinatesJSON = data[<span class="string">"coordinates"</span>] <span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">Double</span>],</div><div class="line">            <span class="keyword">let</span> latitude = coordinatesJSON[<span class="string">"lat"</span>],</div><div class="line">            <span class="keyword">let</span> longitude = coordinatesJSON[<span class="string">"lng"</span>]</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="type">SerializationError</span>.missing(<span class="string">"coordinates"</span>)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">let</span> coordinates = (latitude, longitude)</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">case</span> (-<span class="number">90</span>...<span class="number">90</span>, -<span class="number">180</span>...<span class="number">180</span>) = coordinates <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="type">SerializationError</span>.invaild(<span class="string">"coordinates"</span>, coordinates)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> mealsJSON = data[<span class="string">"meals"</span>] <span class="keyword">as</span>? [<span class="type">String</span>] <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="type">SerializationError</span>.missing(<span class="string">"meals"</span>)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">var</span> meals: <span class="type">Set</span>&lt;<span class="type">Meal</span>&gt; = []</div><div class="line">        <span class="keyword">for</span> string <span class="keyword">in</span> mealsJSON &#123;</div><div class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> meal = <span class="type">Meal</span>(rawValue: string) <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">throw</span> <span class="type">SerializationError</span>.invaild(<span class="string">"meals"</span>, string)</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            meals.insert(meal)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.name = name</div><div class="line">        <span class="keyword">self</span>.coordinates = coordinates</div><div class="line">        <span class="keyword">self</span>.meals = meals</div><div class="line">    &#125;</div><div class="line"></div></pre></td></tr></table></figure>  
<p>这里，<code>Restaurtant</code>类里面声明了一个嵌套的<code>SerializationError</code>类型，定义了关联属性缺失和无效属性两种错误情况。这种抛出错误的构造器强于在序列化错误返回nil的构造器，可以抛出明确的交互错误。这次构造函数同样可以验证数据的合法性。</p>
<h3 id="写获取数据源的类方法"><a href="#写获取数据源的类方法" class="headerlink" title="写获取数据源的类方法"></a>写获取数据源的类方法</h3><p>一个web应用终端通常在单个<code>JSON</code>响应中返回多个数据源。比如<code>/search</code>终端可能返回0或多个匹配查询参数的餐馆，下面一段数据展示这种情况：  </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&#123;</div><div class="line">	<span class="attr">"query"</span>: <span class="string">"sandwich"</span>,</div><div class="line">	<span class="attr">"results_count"</span>: <span class="number">12</span>,</div><div class="line">	<span class="attr">"page"</span>: <span class="number">1</span>,</div><div class="line">	<span class="attr">"results"</span>: [</div><div class="line">		&#123;</div><div class="line">			<span class="attr">"name"</span>: <span class="string">"Caffè Macs"</span>,</div><div class="line">			<span class="attr">"coordinates"</span>: &#123;</div><div class="line">				<span class="attr">"lat"</span>: <span class="number">37.330576</span>,</div><div class="line">				<span class="attr">"lng"</span>: <span class="number">-122.029739</span></div><div class="line">			&#125;,</div><div class="line">			<span class="attr">"meals"</span>: [<span class="string">"breakfast"</span>, <span class="string">"lunch"</span>, <span class="string">"dinner"</span>]</div><div class="line">		&#125;,</div><div class="line">		...</div><div class="line">	]</div><div class="line">&#125;  </div><div class="line"></div></pre></td></tr></table></figure>
<p>你可以在<code>Restaurant</code>结构体中创建一个类方法，将查询条件正确地转化为<br>请求参数，并向服务器发送一个请求。这段代码同时也响应了服务器请求，解析<code>JSON</code>数据，把从<code>results</code>数组中获取的每一个字典转化为<code>Restaurant</code>对象，并在完成处理时自动返回。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Restaurant</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">let</span> urlComponents: <span class="type">URLComponents</span> <span class="comment">// base URL components of the web service</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">let</span> session: <span class="type">URLSession</span> <span class="comment">// shared session for interacting with the web service</span></div><div class="line"></div><div class="line">	<span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">restaurants</span><span class="params">(matching query: String, completion: <span class="params">([Restaurant])</span></span></span> -&gt; <span class="type">Void</span>) &#123;</div><div class="line">		<span class="keyword">var</span> searchURLComponents = urlComponents</div><div class="line">		searchURLComponents.path = <span class="string">"/search"</span></div><div class="line">		searchURLComponents.queryItems = [<span class="type">URLQueryItem</span>(name: <span class="string">"q"</span>, value: query)]</div><div class="line">		<span class="keyword">let</span> searchURL = searchURLComponents.url!</div><div class="line"></div><div class="line">		session.dataTask(url: searchURL, completion: &#123; (<span class="number">_</span>, <span class="number">_</span>, data, <span class="number">_</span>)</div><div class="line">			<span class="keyword">var</span> restaurants: [<span class="type">Restaurant</span>] = []</div><div class="line"></div><div class="line">			<span class="keyword">if</span> <span class="keyword">let</span> data = data,</div><div class="line">				<span class="keyword">let</span> json = <span class="keyword">try</span>? <span class="type">JSONSerialization</span>.jsonObject(with: data, options: []) <span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">Any</span>] &#123;</div><div class="line">				<span class="keyword">for</span> <span class="keyword">case</span> <span class="keyword">let</span> result <span class="keyword">in</span> json[<span class="string">"results"</span>] &#123;</div><div class="line">					<span class="keyword">if</span> <span class="keyword">let</span> restaurant = <span class="type">Restaurant</span>(json: result) &#123;</div><div class="line">						restaurants.append(restaurant)</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line"></div><div class="line">			completion(restaurants)</div><div class="line">		&#125;).resume()</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>  
<p>在viewController中，当搜索条件发生变化时调用这个方法。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">extension ViewController: UISearchResultsUpdating &#123;</div><div class="line">	func updateSearchResultsForSearchController(_ searchController: UISearchController) &#123;</div><div class="line">		<span class="keyword">if</span> let query = searchController<span class="selector-class">.searchBar</span><span class="selector-class">.text</span>, !query<span class="selector-class">.isEmpty</span> &#123;</div><div class="line">			Restaurant.restaurants(matching: query) &#123; restaurants <span class="keyword">in</span></div><div class="line">				self<span class="selector-class">.restaurants</span> = restaurants</div><div class="line">				self<span class="selector-class">.tableView</span><span class="selector-class">.reloadData</span>()</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>  
<p>用这种方式分离管理为获取餐馆数据提供了便利，即使具体实现发生改变。</p>
<h2 id="映射中的映射"><a href="#映射中的映射" class="headerlink" title="映射中的映射"></a>映射中的映射</h2><p>在不同的系统中对相同数据的呈现方式转换对于写软件来说是单调、必要的任务。<br>因为这些呈现方式的结构十分相似，这可能会创建高层级抽象过程去自动在不同呈现间映射。举例来说，一个类可能会为了自动初始化一个模型，利用<code>Swift</code>映射API去定义一种<code>JSON</code>key值和类里面的属性名称之间的映射关系。例如<code>Mirror</code>。<br>然而，我们会发现这些抽象过程性质在<code>Swift</code>语言特性的常规使用场景上并没有提供客观的收益，反而在调试问题和处理额外情景上带来了更多的困扰。通过上面的例子，构造器不但从<code>JSON</code>数据中获取和映射数据，还构造了混合数据类型和执行范围有效性验证。<br>为了实现这些所有的功能，基于映射途径可能会有较大长度。  对于我们的APP来说，评估效率时应该考虑这些。一些重复代码的消耗比使用错误的映射过程更有意义。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/23/TDD-XCTest入门篇/" itemprop="url">
                  TDD-XCTest入门篇
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-23T22:21:45+08:00" content="2016-11-23">
              2016-11-23
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="它是什么"><a href="#它是什么" class="headerlink" title="它是什么"></a>它是什么</h2><p>TDD测试驱动开发，全称为Test Driven Development。XCode自带的单元测试工具</p>
<h2 id="它有什么好处"><a href="#它有什么好处" class="headerlink" title="它有什么好处"></a>它有什么好处</h2><ul>
<li>测试为了线上少出错，发现bug及时修改</li>
<li>不必每次改完一个很小的问题就的重新跑一遍程序</li>
<li>测试为了更好地优化自己代码结构逻辑</li>
</ul>
<h2 id="我怎么用它"><a href="#我怎么用它" class="headerlink" title="我怎么用它"></a>我怎么用它</h2><h3 id="XCT基础配置"><a href="#XCT基础配置" class="headerlink" title="XCT基础配置"></a>XCT基础配置</h3><p><code>XCTestCase</code>是<code>XCTest</code>的具体的子类，开发者可以通过重写此类来测试自己的工程。一个测试类可以有多个测试方法，并且对于所有的测试方法支持创建和清空操作，类层面上的测试也一样。<br>如何定义一个测试类： </p>
<ul>
<li>创建一个<code>XCTestCase</code>的子类，并且以<code>Tests</code>结尾  </li>
<li>实现里面的<code>-test</code>方法</li>
<li>可以定义多个储存当前测试状态的对象或者属性 （可选） </li>
<li>通过初始化<code>-setUp</code>来初始化状态  (可选) </li>
<li>通过重写<code>-tearDown</code>在测试完之后清除 (可选)   </li>
</ul>
<p>测试方法是对象方法 遵守以下约定:  </p>
<ul>
<li>没有参数  </li>
<li>没有返回值  </li>
<li>以test作为方法名前缀</li>
</ul>
<h3 id="XCT基础使用"><a href="#XCT基础使用" class="headerlink" title="XCT基础使用"></a>XCT基础使用</h3><p>测试方法大多都是通过断言来判定是否正确。</p>
<pre><code>func testExample() {

     XCTAssert(f1 + f2 == 5.0, &quot;simple test example&quot;)

 }
</code></pre><p>通过<code>command+R</code>或通过<code>Produnt-&gt; Test</code>来运行测试用例，将会得到以下结果，并且在测试方法的左侧将会有一个菱形标志（正确则显示为绿色，错误则显示为红色）。  </p>
<p>在写测试用例的时候，应该考虑到代码的重用性，项目里面的测试用例都应该有一个共同的父类。父类可以写一些公用的辅助方法以及一些属性。<br>测试方法命名采用<code>test+要测试的方法和类名</code>，这样可以很明确地看出来测试用例的目的。每一个测试用例类都应该对应一个项目工程实际代码类，通常采用<code>类名+Tests</code>命名。禁用一个测试用例的话，只需在方法名之前添加<code>DISABLED</code>。</p>
<blockquote>
<p>这里其实只要方法不是以<code>test</code>开头，XCTest就会在运行时跳过这个方法   </p>
</blockquote>
<p>正在尝试怎么结合实际项目提升开发效率，有了进展在更新。 </p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p> <a href="http://yulingtianxia.com/blog/2014/04/28/iosdan-yuan-ce-shi-xctest/" target="_blank" rel="external">玉令天下的博客</a><br> <a href="https://objccn.io/issue-15-2/" target="_blank" rel="external">XCTest测试实战</a><br> <a href="https://objccn.io/issue-1-3/" target="_blank" rel="external">测试ViewController</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/09/Effective Objective-C 笔记/" itemprop="url">
                  Effective Objective-C 笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-09T22:01:09+08:00" content="2016-11-09">
              2016-11-09
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>前言：</strong>再次读，一样的内容，不一样的感悟。</p>
<h3 id="第一章-熟悉Objective-C"><a href="#第一章-熟悉Objective-C" class="headerlink" title="第一章 熟悉Objective-C"></a>第一章 熟悉Objective-C</h3><h4 id="在类的头文件中尽量少引进其它头文件"><a href="#在类的头文件中尽量少引进其它头文件" class="headerlink" title="在类的头文件中尽量少引进其它头文件"></a>在类的头文件中尽量少引进其它头文件</h4><p>在类的头文件中如果引入其它头文件，那么当前类的头文件被引入时之前引入的头文件也会被同时引入，这将大大延长项目的编译时间，并且能降低类之间的耦合。</p>
<p>优化： 如果当前头文件涉及到其它类时仅仅只声明时，可以使用<code>@class</code>声明欲引用的类，在<code>.m</code>文件中引入类的头文件（向前声明）。对协议而言，尽量将遵守协议的声明移至分类中，再不行，就把协议放在单独的文件中在引入。</p>
<h4 id="多用字面量语法（语法糖）"><a href="#多用字面量语法（语法糖）" class="headerlink" title="多用字面量语法（语法糖）"></a>多用字面量语法（语法糖）</h4><p>字面量语法多用于<code>Foundation</code>框架中的类。使用字面量语法可以有效缩减源代码长度，更加简洁易读。</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">NSString *string = @<span class="string">"kenny best"</span><span class="comment">;</span></div><div class="line">NSArray *array = @[@<span class="string">"kenny"</span>, @<span class="string">"best"</span>]<span class="comment">;</span></div><div class="line">NSDictionary *<span class="keyword">dictionary </span>= @&#123;@<span class="string">"kenny"</span> : @<span class="string">"best"</span>&#125;<span class="comment">;</span></div><div class="line">NSMutableArray *mutableArray = @[@<span class="string">"kenny"</span>, @<span class="string">"best"</span>].mutableCopy<span class="comment">;</span></div><div class="line">NSMutableDictionary *mutableDic = @&#123;@<span class="string">"kenny"</span> : @<span class="string">"best"</span>&#125;.mutableCopy<span class="comment">;</span></div><div class="line">NSNumber *number = @<span class="number">1</span><span class="comment">; // @1.25f @YES @'K'</span></div></pre></td></tr></table></figure>
<blockquote>
<p>使用字面量创建数组、字典时，需要断定值的非空性，否则会抛出异常。使用语法糖创建的字典、数组时应该通过下标操作元素。</p>
</blockquote>
<h4 id="多用类型常量-少用-define"><a href="#多用类型常量-少用-define" class="headerlink" title="多用类型常量 少用#define"></a>多用类型常量 少用#define</h4><p>常量的定义尽可能的避免<code>#define</code>，用<code>#define</code>定义的内容是在编译前进行内容替换。<br>如果定义的常量尽在当前编译单元（实现文件）内有效，那么在此常量前加<code>k</code>标明。如下：</p>
<p><code>static const NSString *name = @&quot;kenny best&quot;;</code></p>
<p>如果定义的常量在多个编译单元时，那么这个常量将放在全局符号表中，使用 <code>extern</code>去声明，并在对应的实现文件中定义值，通常还会以类名作为前缀用于区分。</p>
<p>在<code>.h</code>中<code>extern cosnt NSString *name;</code>声明， </p>
<p>在<code>.m</code>中<code>const NSString *name = @&quot;kenny best&quot;;</code>定义</p>
<blockquote>
<p>类型常量声明的时候已经确定类型，并且添加限制，可以借助编译器来确保常量正确。</p>
</blockquote>
<h4 id="使用枚举表示状态、选项"><a href="#使用枚举表示状态、选项" class="headerlink" title="使用枚举表示状态、选项"></a>使用枚举表示状态、选项</h4>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/18/最近一段生活/" itemprop="url">
                  永恒之源
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-18T21:12:57+08:00" content="2016-09-18">
              2016-09-18
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>前言：</strong>已经过完中秋了，一直想搭建一个自己的博客也弄好了。记录一下搭建的过程，再闲聊一下最近的生活和YY一下未来。</p>
<h2 id="Hexo搭建"><a href="#Hexo搭建" class="headerlink" title="Hexo搭建"></a>Hexo搭建</h2><p>博客是放在Github上，Github配置就不提了。简单说一下Hexo的配置。</p>
<h3 id="静态博客配置"><a href="#静态博客配置" class="headerlink" title="静态博客配置"></a>静态博客配置</h3><blockquote>
<p>安装Hexo需要Node.js和Git。在Mac里面安装Node.js最好的方式就是实用nvm去安装。</p>
</blockquote>
<h4 id="nvm安装"><a href="#nvm安装" class="headerlink" title="nvm安装"></a>nvm安装</h4><ul>
<li>可以去看一下nvm的Github主页<code>https://github.com/creationix/nvm</code><a href="https://github.com/creationix/nvm" target="_blank" rel="external">链接</a></li>
</ul>
<h4 id="Hexo安装"><a href="#Hexo安装" class="headerlink" title="Hexo安装"></a>Hexo安装</h4><p>所需的库组件安装完成后，就可以傻瓜式地安装Hexo了。</p>
<p>1.命令行输入<code>npm install -g hexo-cli</code></p>
<p>2.hexo的构建 我安装的时候先<code>cd</code>到我想要安装的目标文件内，再去执行<code>hexo init</code>，然后执行<code>npm install</code>。</p>
<blockquote>
<p>Hexo的文件所代表的含义和功能会在下面的参考资料中给出链接</p>
</blockquote>
<p>3.hexo的样式配置 所有的配置信息都在<code>_config.yml</code>中</p>
<h3 id="Github-Page绑定"><a href="#Github-Page绑定" class="headerlink" title="Github Page绑定"></a>Github Page绑定</h3><p>现在对于程序员来说<code>Github</code>应该不会陌生，如果你没听过，可以先Google一下。登录自己的Github帐号，创建一个固定样式<code>用户名.github.io</code>的仓库。例如：<code>KennyBest.github.io</code>。</p>
<p>接下来打开<code>_config.yml</code>，找到对应的deploy这一项。</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">type:</span> git</div><div class="line"><span class="symbol">repo:</span> 填入自己上一步创建的仓库的地址</div><div class="line"><span class="symbol">branch:</span> master</div></pre></td></tr></table></figure>
<blockquote>
<p>这里Git的方式需要在命令行输入<code>npm install hexo-deployer-git --save</code>来安装所需的插件</p>
</blockquote>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><blockquote>
<p>吃水不忘挖井人</p>
</blockquote>
<p><a href="https://hexo.io/zh-cn/docs" target="_blank" rel="external">Hexo的中文文档</a></p>
<p><a href="http://www.zhihu.com/question/24422335" target="_blank" rel="external">Hexo主题介绍</a></p>
<h2 id="最近生活"><a href="#最近生活" class="headerlink" title="最近生活"></a>最近生活</h2><p>  从年后加入可得(谢谢我原先同事的内推)到现在，一直在做可得眼镜这个项目。刚开始app还未上线，一边先熟悉项目逻辑，一边改一下测试提出的bug。大家都为上线卯足了劲，测试加班测app，开发加班完善功能。测啊测，测到加入购物车模块，炸了，测试测不下去，我也无从下手去改啊，每一步都是bug（原先写的哥们真tm的省事了）。跟同事商量后确定重写，此时业务逻辑还不怎么清楚，有点烦但是没办法，你得上啊。重写加入购物车模块算是正式融入到这个项目的开始吧。一边听测试讲业务逻辑，一边开发（谢谢测试同事的讲解）。这个模块写完功能实现了，但是有点乱（终于在前几天没事的时候把它重构了）。之后接着改购物车模块。</p>
<p>  最近一段时间一直搞可得直播模块，推流／拉流／互动交互这些基本的功能实现，再加上可得项目本质<code>电商</code>特色（直播推动商品销售）这一功能。中间又搞了一段美瞳试戴开发。</p>
<blockquote>
<p>中间由于大家都懂的原因，心态出现了一次落潮</p>
</blockquote>
<h2 id="YY未来"><a href="#YY未来" class="headerlink" title="YY未来"></a>YY未来</h2><p>未来到底是什么样子？我不知道，所以只能YY一下。我喜欢技术，但是还不是很纯粹（纯粹算是理想）。</p>
<p>我希望自己未来是多姿多彩的，充满阳光。</p>
<p>Fighting!</p>
<blockquote>
<p>我喜欢C++，没有任何原因的喜欢。</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="李令洁" />
          <p class="site-author-name" itemprop="name">李令洁</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">5</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/KennyBest" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/2485490413/profile?rightmod=1&wvr=6&mod=personinfo&is_all=1" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">李令洁</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  

  

  

  

</body>
</html>
